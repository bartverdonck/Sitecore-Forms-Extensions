@using System.Web.Mvc
@using System.Web.Mvc.Html
@using Feature.FormsExtensions
@using Feature.FormsExtensions.Views
@using Sitecore.ExperienceForms.Mvc.Html
@using Sitecore.Mvc
@model Feature.FormsExtensions.Fields.ReCaptcha.ReCaptchaModel
@{
  var fieldId = Html.IdFor(m => Model.CaptchaValue);
  Html.AddScript(ScriptStore.ValidateScriptKey, new MvcHtmlString("<script src=\"/sitecore%20modules/Web/ExperienceForms/scripts/formsextensions.validate.js\"></script>"));
}

<div id="@(fieldId)_wrapper"></div>
<input id="@fieldId" name="@Html.NameFor(m => Model.CaptchaValue)" type="hidden" class="fxt-captcha" @Html.GenerateUnobtrusiveValidationAttributes(m => m.CaptchaValue) />
@Html.ValidationMessageFor(m => Model.CaptchaValue)

@if (Html.Sitecore().IsExperienceFormsEditMode())
{
  <img src="data:image/png;base64,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" />
}
else { 
<script type="text/javascript">
  var reCaptchaArray = reCaptchaArray || [];
  reCaptchaArray.push(
    function() {
      var _captchaInput = window.document.getElementById('@fieldId');
      window.grecaptcha.render('@(fieldId)_wrapper',
        {
          'sitekey': '@Model.CaptchaPublicKey',
          'callback': function(token) {
            _captchaInput.value = token;
          },
          'expired-callback': function(args) {
            _captchaInput.value = '';
          }
        });
    }
  );
</script>
  <script src="https://www.google.com/recaptcha/api.js?onload=loadReCaptchas&render=explicit&hl=@Sitecore.Context.Language.CultureInfo.TwoLetterISOLanguageName" async defer></script>
}